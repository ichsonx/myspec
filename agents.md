# OpenSpec 工作流指引（自定义规范版）

你将协助我完成基于 **需求 ID** 的规范驱动开发。请严格遵守以下规则：

## 🚀 启动与状态同步协议

当用户提供 `spec.md` + `tasks.md` 后，**你必须主动执行以下动作**：
1. **自动扫描 `tasks.md` 中首个未完成任务**（即第一个 `[ ] 编号.`）；
2. **输出标准化启动声明**：
   > "我将实现 `{需求 ID}` 的任务。当前首个未完成任务：`{编号}` —— `{描述摘要}`。"  
   > *（示例：我将实现 `REQ-2025-001` 的任务。当前首个未完成任务：`2.4` —— 更新筛选器显示文本）*
3. **仅当该任务完成后，再继续下一个未完成任务**，依此类推。

⚠️ 禁止行为：
- 询问"接下来做什么？"
- 一次性列出多个任务
- 跳过未完成任务处理后续

## 🤖 AI行为约束协议

为确保规范驱动开发的准确性，AI必须遵守以下真实性约束：

### 禁止AI幻觉与虚构
- **禁止编造**未在 `spec.md` 或 `tasks.md` 中明确定义的技术细节
- **禁止臆想**未在文档中提及的业务逻辑、API接口、数据库结构等
- **禁止伪造**代码实现细节、配置参数、第三方库版本等信息
- **禁止推测**未在需求中明确的功能行为或用户场景

### 事实依据原则
- 所有实现必须严格基于 `spec.md` 中定义的场景和验收条件
- 所有代码片段和实现细节应参考 `tasks.md` 中提供的示例
- 当文档信息不足时，应提示用户补充规范，而非自行扩展

### 优化建议协议
- 当AI分析 `spec.md` 和 `tasks.md` 后发现有优化空间时，应使用以下格式询问用户：
  > "对于 任务-X.Y 的...我有{优化建议}...是否接纳并更新到本次计划中？"
- 此格式适用于所有AI提出的优化建议，确保清晰明确地传达改进意图

### 透明性要求
- 如发现规范文档存在不一致或模糊之处，应明确指出
- 对于可选实现方案，应说明选择依据并建议在规范中明确

## 📁 文件结构
所有变更位于 `openspec/changes/REQ-XXXX-XXX_slug/`，含两文件：
- `spec.md`：完整 PRD（含需求 ID、场景、技术规格、验收条件）
- `tasks.md`：用户故事拆解 + 可勾选任务

## 📝 spec.md 规则
- 元数据（最后更新日期/提出者/作者/归属模块）置于 `需求 ID` 下，用 `──────────────` 分隔线包裹，**不用标题**
- 必须包含 `## 技术/数据规格` 标题（内容可空）
- 每个场景（如 `### 场景-X`）必须有 `### 验收条件：`（含中文冒号），后接零个至多个验收项（如 `- [x] 列表人数 = ...`）
- 每个场景后应包含 `**关联用户故事**：用户故事-X` 字段

## 📋 tasks.md 规则
- 每个 `## 用户故事-X` 必须声明：
  - `**归属场景**：场景-X`（可多个）
  - `**验收条件：**`（含中文冒号，后接具体项。可包含零个至多个。）
- 任务格式：`- [ ] **任务-X.Y**：描述`，完成后改为 `- [x]`
- 下次只处理未打钩任务

## ✅ 协作示例
我提供 `spec.md` + `tasks.md` 后，你可：
> "我将实现 `REQ-2025-001` 的任务。当前未完成任务：任务-2.3, 任务-3.2。先处理 任务-2.3：实现日期校验逻辑……"